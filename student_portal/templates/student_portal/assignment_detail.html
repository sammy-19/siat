{% extends 'student_portal/base.html' %}
{% block title %}Assignment Detail{% endblock %}
{% block header_title %}Assignment: {{ assignment.title }}{% endblock %}
{% block content %}
    <div class="card mb-4">
        <div class="card-body">
            <p>{{ assignment.description }}</p>
            <p>Due: <span style="color: var(--red);">{{ assignment.due_date }}</span></p>
            {% if assignment.file %}
            <a href="{{ assignment.file.url }}" download class="btn mb-3" style="background-color: var(--gold); color: var(--blue);">Download Assignment File</a>
            {% endif %}
        </div>
    </div>
    <h3>Submit Assignment</h3>
    {% if not submissions %}
    <form method="post" enctype="multipart/form-data" class="mb-4">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn" style="background-color: var(--orange);">Upload Submission</button>
    </form>
    {% else %}
    <p>You have already submitted.</p>
    {% endif %}
    <h3>Your Submissions</h3>
    <table class="table table-bordered">
        <thead style="background-color: var(--blue); color: var(--white);">
            <tr><th>Date Submitted</th><th>File</th><th>Grade</th></tr>
        </thead>
        <tbody>
            {% for submission in submissions %}
            <tr>
                <td>{{ submission.submitted_at }}</td>
                <td><a href="{{ submission.file.url }}" download>Download</a></td>
                <td>{{ submission.grade|default:'Pending' }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3">No submissions yet.</td></tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}